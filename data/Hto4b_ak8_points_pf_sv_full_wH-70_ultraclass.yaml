selection:
   (fj_sdmass > 10) & (fj_eta > -2.4) & (fj_eta < 2.4) & (fj_pt > 170) & (fj_pt < 7000) & ((label_H_aa_bbbb+label_H_aa_other+sample_isQCD+fj_isISR+fj_isNR) == 1) & ((event_no % 2) == 0)

test_time_selection:
   (fj_sdmass > 10) & (fj_eta > -2.4) & (fj_eta < 2.4) & (fj_pt > 170) & (fj_pt < 7000)

new_variables:
   pfcand_mask: awkward.JaggedArray.ones_like(pfcand_etarel)
   sv_mask: awkward.JaggedArray.ones_like(sv_etarel)
   ## Extra event labels
   # H_aa_same_mass: (label_H_aa_bbbb==1) & ((fj_gen_H_aa_bbbb_mass_a1/fj_gen_H_aa_bbbb_mass_a2)<=1.2)
   # H_aa_diff_mass: (label_H_aa_bbbb==1) & ((fj_gen_H_aa_bbbb_mass_a1/fj_gen_H_aa_bbbb_mass_a2) >1.2)
   Haa4b:  (label_H_aa_bbbb==1)
   Haa3b:  (label_H_aa_other==1) & (fj_nbHadrons>=3)
   Haa2b:  (label_H_aa_other==1) & (fj_nbHadrons==2)
   Haa01b: (label_H_aa_other==1) & (fj_nbHadrons<=1)
   QCD0b: (sample_isQCD==1) & (fj_nbHadrons==0)
   QCD1b: (sample_isQCD==1) & (fj_nbHadrons==1)
   QCD2b: (sample_isQCD==1) & (fj_nbHadrons==2) & (fj_ncHadrons<4)
   QCD2b2c: (sample_isQCD==1) & (fj_nbHadrons==2) & (fj_ncHadrons>=4)
   QCD3b: (sample_isQCD==1) & (fj_nbHadrons==3)
   QCD4b: (sample_isQCD==1) & (fj_nbHadrons>=4)
   ISR0b: (fj_isISR==1) & (fj_nbHadrons==0)
   ISR1b: (fj_isISR==1) & (fj_nbHadrons==1)
   ISR2b: (fj_isISR==1) & (fj_nbHadrons==2) & (fj_ncHadrons<4)
   ISR2b2c: (fj_isISR==1) & (fj_nbHadrons==2) & (fj_ncHadrons>=4)
   ISR3b: (fj_isISR==1) & (fj_nbHadrons==3)
   ISR4b: (fj_isISR==1) & (fj_nbHadrons>=4)
   NR0b: (fj_isNR==1) & (label_NR_lep==0) & (fj_nbHadrons==0)
   NR1b: (fj_isNR==1) & (label_NR_lep==0) & (fj_nbHadrons==1)
   NR2b: (fj_isNR==1) & (label_NR_lep==0) & (fj_nbHadrons==2) & (fj_ncHadrons<4)
   NR2b2c: (fj_isNR==1) & (label_NR_lep==0) & (fj_nbHadrons==2) & (fj_ncHadrons>=4)
   NR3b: (fj_isNR==1) & (label_NR_lep==0) & (fj_nbHadrons==3)
   NR4b: (fj_isNR==1) & (label_NR_lep==0) & (fj_nbHadrons>=4)
   NRlep: (label_NR_lep==1)
   Other: (label_H_aa_bbbb+label_H_aa_other+sample_isQCD+fj_isISR+fj_isNR!=1)
   label_QCD_LHE_300:  (sample_min_LHE_HT== 300)
   label_QCD_LHE_500:  (sample_min_LHE_HT== 500)
   label_QCD_LHE_700:  (sample_min_LHE_HT== 700)
   label_QCD_LHE_1000: (sample_min_LHE_HT==1000)
   label_QCD_LHE_1500: (sample_min_LHE_HT==1500)
   label_QCD_LHE_2000: (sample_min_LHE_HT==2000)
   ## Event weight used in reweight_classes below
   event_weight_wH70:  (Other*1.0 + fj_isISR*1.0 + fj_isNR*1.0 + label_H_aa_bbbb*10. + label_H_aa_other*10. + label_QCD_LHE_300*1.0 + label_QCD_LHE_500*1.0 + label_QCD_LHE_700*1.2 + label_QCD_LHE_1000*0.9 + label_QCD_LHE_1500*0.2 + label_QCD_LHE_2000*0.05)
   ## event_weight_mH125: (label_H_aa_bbbb*1.5 + label_H_aa_other*1.5 + label_QCD_LHE_500*0.3 + label_QCD_LHE_700*2.0 + label_QCD_LHE_1000*1.0 + label_QCD_LHE_1500*0.2)

preprocess:
  method: manual
  data_fraction: 

inputs:
   pf_points:
      length: 100
      vars: 
         - pfcand_etarel
         - pfcand_phirel
   pf_features:
      length: 100
      vars: 
         - [pfcand_pt_log_nopuppi, 1, 0.5]
         - [pfcand_e_log_nopuppi, 1.3, 0.5]
         - pfcand_etarel
         - pfcand_phirel
         - [pfcand_abseta, 0.6, 1.6]
         - pfcand_charge
         - pfcand_isEl
         - pfcand_isMu
         - pfcand_isGamma
         - pfcand_isChargedHad
         - pfcand_isNeutralHad
         - [pfcand_VTX_ass, 4, 0.3]
         - pfcand_lostInnerHits
         - [pfcand_normchi2, 5, 0.2]
         - [pfcand_quality, 0, 0.2]
         - [pfcand_dz, 0, 180]
         - [pfcand_dzsig, 0, 0.9]
         - [pfcand_dxy, 0.0, 300]
         - [pfcand_dxysig, 0, 1.0]
         - [pfcand_btagEtaRel, 1.5, 0.5]
         - [pfcand_btagPtRatio, 0, 1]
         - [pfcand_btagPParRatio, 0, 1]
         - [pfcand_btagSip3dVal, 0, 100]
         - [pfcand_btagSip3dSig, 0, 0.5]
         - [pfcand_btagJetDistVal, 0, 40]
   pf_mask:
      length: 100
      vars: 
         - pfcand_mask
   sv_points:
      length: 10
      vars:
         - sv_etarel 
         - sv_phirel
   sv_features:
      length: 10
      vars:
         - [sv_pt_log, 4, 0.6]
         - [sv_mass, 1.2, 0.3]
         - sv_etarel
         - sv_phirel
         - [sv_abseta, 0.5, 1.6]
         - [sv_ntracks, 3, 1]
         - [sv_normchi2, 0.8, 0.6]
         - [sv_dxy, 0.4, 0.25]
         - [sv_dxysig, 7, 0.02]
         - [sv_d3d, 0.5, 0.2]
         - [sv_d3dsig, 7, 0.02]
   sv_mask:
      length: 10
      vars:
         - sv_mask

labels:
   type: simple
   value: [
      ## H_aa_same_mass, H_aa_diff_mass,
      Haa4b, Haa3b, Haa2b, Haa01b,
      QCD4b, QCD3b, QCD2b2c, QCD2b, QCD1b, QCD0b,
      ISR4b, ISR3b, ISR2b2c, ISR2b, ISR1b, ISR0b,
      NR4b, NR3b, NR2b2c, NR2b, NR1b, NR0b, NRlep
      ]

observers:
   - event_no
   - event_weight_wH70
   ## - event_weight_mH125
   - jet_no
   - npv
   - n_sv
   - sample_isQCD
   - sample_min_LHE_HT
   - fj_label
   - fj_isTT
   - fj_isTop
   - fj_isW
   - fj_isZ
   - fj_isH
   - fj_isISR
   - fj_isQCD
   - fj_isNR
   - label_H_aa_bbbb
   - label_H_aa_other
   - label_QCD_others
   - label_QCD_BGen
   - label_QCD_bEnr
   - label_QCD_Incl
   - label_QCD_bb
   - label_QCD_cc
   - label_QCD_b
   - label_QCD_c
   - label_NR_LF
   - label_NR_b
   - label_NR_bb
   - label_NR_lep
   - label_TT_ISR
   - label_TT_q
   - label_TT_b
   - label_TT_bq
   - label_TT_qq
   - label_TT_bqq
   - label_TT_l
   - label_TT_bl
   - label_TT_q_q
   - label_TT_b_q
   - label_TT_bq_q
   - label_TT_qq_q
   - label_TT_bqq_q
   - label_TT_l_q
   - label_TT_bl_q
   - label_TT_b_b
   - label_TT_bq_b
   - label_TT_qq_b
   - label_TT_bqq_b
   - label_TT_l_b
   - label_TT_bl_b
   - label_TT_bq_bq
   - label_TT_qq_bq
   - label_TT_bqq_bq
   - label_TT_l_bq
   - label_TT_bl_bq
   - label_TT_qq_qq
   - label_TT_bqq_qq
   - label_TT_l_qq
   - label_TT_bl_qq
   - label_TT_bqq_bqq
   - label_TT_l_bqq
   - label_TT_bl_bqq
   - label_TT_l_l
   - label_TT_bl_l
   - label_TT_bl_bl
   - fj_gen_pt
   - fj_gen_mass
   - fj_genjet_pt
   - fj_genjet_mass
   - fj_genjet_sdmass
   - fj_gen_H_aa_bbbb_mass_H
   - fj_gen_H_aa_bbbb_mass_a1
   - fj_gen_H_aa_bbbb_mass_a2
   - fj_gen_H_aa_bbbb_dR_max_b
   - fj_gen_H_aa_bbbb_pt_min_b
   - fj_nbHadrons
   - fj_ncHadrons
   - fj_pt
   - fj_eta
   - fj_phi
   - fj_mass
   - fj_sdmass
   - fj_corrsdmass
   - fj_sdmass_fromsubjets
   - fj_doubleb
   - fj_tau1
   - fj_tau2
   - fj_tau3
   - fj_tau21
   - fj_tau32
   - fj_n_sdsubjets
   - fj_sdsj1_pt
   - fj_sdsj1_eta
   - fj_sdsj1_phi
   - fj_sdsj1_mass
   - fj_sdsj1_mult
   - fj_sdsj1_csv
   - fj_sdsj2_pt
   - fj_sdsj2_eta
   - fj_sdsj2_phi
   - fj_sdsj2_mass
   - fj_sdsj2_mult
   - fj_sdsj2_csv
   - pfParticleNetMassRegressionJetTags_mass
   - pfParticleNetDiscriminatorsJetTags_HbbvsQCD
   - pfParticleNetDiscriminatorsJetTags_H4qvsQCD
   - pfMassDecorrelatedParticleNetDiscriminatorsJetTags_XbbvsQCD
   - pfMassDecorrelatedDeepBoostedDiscriminatorsJetTags_HbbvsQCD
   - pfMassDecorrelatedDeepBoostedDiscriminatorsJetTags_bbvsLight

weights:
   use_precomputed_weights: false
   reweight_method: flat
   reweight_vars:
      fj_pt: [0, 10000]
      fj_eta: [-5.0, 5.0]
   reweight_classes: [ Other, fj_isISR, fj_isNR, label_H_aa_bbbb, label_H_aa_other, label_QCD_LHE_300, label_QCD_LHE_500, label_QCD_LHE_700, label_QCD_LHE_1000, label_QCD_LHE_1500, label_QCD_LHE_2000 ]
   class_weights: [1.0, 1.0, 1.0, 10.0, 10.0, 1.0, 1.0, 1.2, 0.9, 0.2, 0.05]
   ## class_weights: [ 1.5,  1.5, 0.3, 2.0, 1.0, 0.2]
